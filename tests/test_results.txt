============================= test session starts ==============================
platform darwin -- Python 3.10.13, pytest-8.2.2, pluggy-1.5.0
rootdir: /Users/danilocoutodesouza/Documents/Programs_and_scripts/lorenz-cycle
collected 2 items

tests/test_lec_fixed_framework.py F                                      [ 50%]
tests/test_main.py F                                                     [100%]

=================================== FAILURES ===================================
______________ TestLECFixedFramework.test_lec_fixed_functionality ______________

self = <tests.test_lec_fixed_framework.TestLECFixedFramework testMethod=test_lec_fixed_functionality>
mock_open = <MagicMock name='open' spec='builtin_function_or_method' id='6309214960'>
mock_read_csv = <MagicMock name='read_csv' id='6309696160'>
mock_open_dataset = <MagicMock name='open_dataset' id='6309770864'>
mock_gdt = <MagicMock name='GenerationDissipationTerms' id='6309795136'>
mock_bt = <MagicMock name='BoundaryTerms' id='6309802960'>
mock_ct = <MagicMock name='ConversionTerms' id='6309827232'>
mock_ec = <MagicMock name='EnergyContents' id='6309835056'>
mock_box = <MagicMock name='BoxData' id='6309875712'>
mock_path_isdir = <MagicMock name='isdir' id='6309883536'>
mock_path_exists = <MagicMock name='exists' id='6309891424'>

    @patch('src.frameworks.lec_fixed_framework.os.path.exists', side_effect=mock_exists_side_effect)
    @patch('src.frameworks.lec_fixed_framework.os.path.isdir', return_value=True)
    @patch('src.frameworks.lec_fixed_framework.BoxData')
    @patch('src.frameworks.lec_fixed_framework.EnergyContents')
    @patch('src.frameworks.lec_fixed_framework.ConversionTerms')
    @patch('src.frameworks.lec_fixed_framework.BoundaryTerms')
    @patch('src.frameworks.lec_fixed_framework.GenerationDissipationTerms')
    @patch('src.frameworks.lec_fixed_framework.xr.open_dataset')
    @patch('pandas.read_csv')
    @patch("builtins.open", new_callable=unittest.mock.mock_open)
    def test_lec_fixed_functionality(self, mock_open, mock_read_csv, mock_open_dataset, mock_gdt, mock_bt, mock_ct, mock_ec, mock_box, mock_path_isdir, mock_path_exists):
        # Mocking xr.open_dataset to return a specific xarray.Dataset
        mock_open_dataset.return_value = self.data
    
        # Create a mock DataFrame with the correct structure
        mock_df = pd.DataFrame({'Value': [-60, -30, -42.5, -17.5]}, index=['min_lon', 'max_lon', 'min_lat', 'max_lat'])
        mock_read_csv.return_value = mock_df
    
        # Call lec_fixed
>       lec_fixed(self.data, self.variable_list_df, self.results_subdirectory, self.args)
E       TypeError: lec_fixed() missing 1 required positional argument: 'args'

tests/test_lec_fixed_framework.py:90: TypeError
______________________________ test_example_args _______________________________

monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x178197880>

    def test_example_args(monkeypatch):
        # Example usage for debugging
        test_args = ['lorenzcycletoolkit.py', 'samples/Reg1-Representative_NCEP-R2.nc', '-r', '-f', '-p', '-v']
        monkeypatch.setattr('sys.argv', test_args)
    
        parser = create_arg_parser()
        args = parser.parse_args()
    
>       assert args.r == True
E       AttributeError: 'Namespace' object has no attribute 'r'

tests/test_main.py:12: AttributeError
=============================== warnings summary ===============================
../../../anaconda3/envs/lorenz/lib/python3.10/site-packages/cdsapi/api.py:17
  /Users/danilocoutodesouza/anaconda3/envs/lorenz/lib/python3.10/site-packages/cdsapi/api.py:17: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

tests/test_lec_fixed_framework.py::TestLECFixedFramework::test_lec_fixed_functionality
  /Users/danilocoutodesouza/anaconda3/envs/lorenz/lib/python3.10/site-packages/gribapi/__init__.py:23: UserWarning: ecCodes 2.31.0 or higher is recommended. You are running version 2.30.0
    warnings.warn(

tests/test_lec_fixed_framework.py::TestLECFixedFramework::test_lec_fixed_functionality
  <frozen importlib._bootstrap>:241: RuntimeWarning: numpy.ndarray size changed, may indicate binary incompatibility. Expected 16 from C header, got 96 from PyObject

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/test_lec_fixed_framework.py::TestLECFixedFramework::test_lec_fixed_functionality
FAILED tests/test_main.py::test_example_args - AttributeError: 'Namespace' ob...
======================== 2 failed, 3 warnings in 1.59s =========================
